{% extends 'base.html.twig' %}

{% block title %}Evenement{% endblock %}


{% block content %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function(){
            $('#imgDiv').hide();
            $('#btn1').click(function(){
                $('#imgDiv').show();
            });
            $('#btn2').click(function(){
                $('#imgDiv').hide();
            });
        });
    </script>
    <h1>Evenement</h1>
    <div id="content-page" class="content-page">
        <div class="container">
            <div class="row">
                <div class="col-lg-11">
                    <div class="iq-card" >
                        <div class="iq-card-header d-flex justify-content-between">
                            <div class="iq-header-title">
                                <ul class="d-flex align-items-center justify-content-between list-inline m-0 p-0">
                                    <div class="container1">
                                        <img src="{{ asset('imagesCategorie/')~ evenement.categorie.categorieImage ~''}}" class="image1" margin-right="0"  overflow="visible" alt="{{evenement.categorie}}">
                                        <div class="overlay1">
                                            <div >{{ evenement.categorie }}</div>
                                        </div>
                                    </div>
                                    <div  class="media-support-user-img mr-3">

                                        <img class="rounded-circle img-fluid" src="{{ asset('images/user/03.jpg') }}" alt="">
                                    </div>
                                    <div class="media-support-info mt-2">


                                        <h5 class="mb-0 d-inline-block"><a href="#" class="">{{ evenement.idOrg}}</a></h5>
                                        <a href="{{ path('evenement_show', {'id': evenement.id}) }}"  class="mb-0 d-inline-block">{{'Is Hosting ' ~ evenement.nomEvent}}</a>


                                    </div>
                                <li>
                                    <button style="position: absolute; top:10px; left: 700px; " class="btn btn-primary" type="button" id="btn1">Get Event QR code</button>
                                    <div id="imgDiv">
                                        <p><img class="img-scale2" style="position: absolute; top:45px; left: 785px; " src="{{ qr_code_path('Event name:  ' ~ evenement.nomEvent  ~'\nRemaining spots:  ' ~ evenement.capaciteEvent   ~'\nEvent Location:  ' ~ evenement.locationEvent  ) }}"  width="8%" height="auto"   border="0"></p>
                                    </div>
                                </li>

                                </ul>
                            </div>
                        </div>
                        <div class="iq-card-body">

                            <h6>{{ evenement.description }}</h6>

                            <img src="{{ asset('imagesEvent/')~ evenement.imageEvent ~''}}"  class="img-fluid rounded w-100">


                            <div class="iq-card-body text-center">
                            <div class="group-details d-inline-block pb-3">
                                <ul class="d-flex align-items-center justify-content-between list-inline m-0 p-0">
                                    <li class="pl-3 pr-3">
                                        <ul class="d-flex align-items-center justify-content-between list-inline m-0 p-0">
                                            <img width="20%" height="auto" src="{{ asset('javaicons/location.png')}}" >
                                            <p class="mb-0">Event Location</p>
                                        </ul>

                                        <h6>{{  evenement.locationEvent }}</h6>
                                    </li>
                                    <li class="pl-3 pr-3">
                                        <ul class="d-flex align-items-center justify-content-between list-inline m-0 p-0">
                                            <img width="20%" height="auto" src="{{ asset('javaicons/calendar.png')}}" >
                                            <p class="mb-0">Event Date</p>
                                        </ul>
                                        <h6>{{ evenement.date ? evenement.date|date('Y-m-d') : '' }}</h6>
                                    </li>
                                    <li class="pl-3 pr-3">
                                        <ul class="d-flex align-items-center justify-content-between list-inline m-0 p-0">
                                            <img width="20%" height="auto" src="{{ asset('javaicons/icons8_Person_32px.png')}}" >
                                            <p class="mb-0">Event Capacity</p>
                                        </ul>
                                        <h6>{{ evenement.capaciteEvent }}</h6>
                                    </li>


                                </ul>
                            </div>
                            </div>
                            <div class="comment-area mt-3">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="like-block position-relative d-flex align-items-center">
                                        <div class="d-flex align-items-center">
                                            <div class="like-data">
                                                <div class="dropdown">
                                                <span class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" role="button">
                                                  <form  id="JoinForm" method="post" action="{{ path('participant_newTrying')}}" >
                                                      <input  type="hidden" name="myEvent" id="myEvent" type="text" value={{ evenement.nomEvent}}>
                                                {% if date(evenement.date) > date() %}
                                                <img   id="reloader" onclick="document.getElementById('JoinForm').submit();" src="{{ asset('images/icon/14.png') }}" class="img-fluid" alt="Join">
{% endif %}

                                                      <!------------------------  Refresh Script  --------------------- -->
                                                    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
                                                    <script type="text/javascript">
                                                        $("#reloader").click(function () {
                                                            $("#comment_area").load(" #comment_area");

                                                        });
                                                    </script>
                                                      <!------------------------  Refresh Script  --------------------- -->


                                                  </form>


                                                </span>
                                                    <div class="dropdown-menu">
                                                        <a class="dropdown-item" href="#" >Join</a>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="total-like-block ml-2 mr-3">
                                                <div class="dropdown">
                                                <span class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" role="button">
                                                 {% if date(evenement.date) > date() %}
                                                    {{ evenement.nbMax-evenement.capaciteEvent }} People going
                                                    {% else %}
                                                    {{ evenement.nbMax-evenement.capaciteEvent }} People have been there
                                                    {% endif %}
                                                </span>
                                                    <div class="dropdown-menu">
                                                        <a class="dropdown-item" href="#">Max Emum</a>
                                                        <a class="dropdown-item" href="#">Bill Yerds</a>
                                                        <a class="dropdown-item" href="#">Hap E. Birthday</a>
                                                        <a class="dropdown-item" href="#">Tara Misu</a>
                                                        <a class="dropdown-item" href="#">Midge Itz</a>
                                                        <a class="dropdown-item" href="#">Sal Vidge</a>
                                                        <a class="dropdown-item" href="#">Other</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="total-comment-block">
                                            <div class="dropdown">
                                             <span class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" role="button">
                                             20 Comment
                                             </span>
                                                <div class="dropdown-menu">
                                                    <a class="dropdown-item" href="#">Max Emum</a>
                                                    <a class="dropdown-item" href="#">Bill Yerds</a>
                                                    <a class="dropdown-item" href="#">Hap E. Birthday</a>
                                                    <a class="dropdown-item" href="#">Tara Misu</a>
                                                    <a class="dropdown-item" href="#">Midge Itz</a>
                                                    <a class="dropdown-item" href="#">Sal Vidge</a>
                                                    <a class="dropdown-item" href="#">Other</a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <link rel="stylesheet" href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css">

                                        <div class="share-block d-flex align-items-center feather-icon mr-3">
                                            <form  id="RatingForm" method="post" action="{{ path('rating_event_new')}}" >
                                                {% if date(evenement.date) < date() %}
                                                <div class="stars">
                                                <i class="lar la-star"  data-value="1" ></i><i class="lar la-star"  data-value="2"></i><i class="lar la-star"  data-value="3"></i><i class="lar la-star"  data-value="4"></i><i class="lar la-star"  data-value="5"></i>
                                            </div>
                                                {% endif %}
                                            <input type="hidden" name="note" id="note" value="0">
                                            <input  type="hidden" name="ratedEvent" id="ratedEvent" type="text" value={{evenement.nomEvent}}>
                                            <script src="{{ asset('js/scripts.js') }}"></script>

                                            <span  class="ml-1">{{ 'Rating : ' ~ evenement.ratingEvent ~ '/5   '}}</span></a>
                                                {% if date(evenement.date) < date() %}
                                                <button  class="btn btn-primary" type="submit"> ✓ </button>
                                                {% endif %}
                                            </form>
                                        </div>
                                </div>

                                </div>
                                <hr>
                                <ul class="post-comments p-0 m-0">
                                    {% if comments %}
                                    {% for comment in comments %}
                                    <li class="mb-2">
                                        <div class="d-flex flex-wrap">
                                            <form  id="myform" method="post" action="{{ path('comment_event_delete') }}" onsubmit="return confirm('Are you sure you want to delete this item?');">
                                                {%  if comment.idUser == CurrentUser.username %}
                                                <div class="d-flex align-items-top">
                                                    <div  onclick="document.getElementById('myform').submit();" type="submit" class="icon font-size-20"><i style="position: absolute; left: 725px; "  class="ri-close-circle-line"></i></div>
                                                    <input  type="hidden" name="deletedEvent" id="deletedEvent" type="text" value={{ evenement.nomEvent}}>
                                                    <input  type="hidden" name="deletedComment" id="deletedComment" type="text" value={{comment.id}}>

                                                    <div class="data ml-2">

                                                        <h6 style="position: absolute; left: 750px; "  onclick="document.getElementById('myform').submit();">Delete Comment</h6>


                                                    </div>

                                                </div>
                                                {% endif %}
                                            </form>
                                            <div class="user-img">
                                                <img src="{{ asset('images/user/02.jpg') }}" alt="userimg" class="avatar-35 rounded-circle img-fluid">
                                            </div>
                                            <div class="comment-data-block ml-3">
                                                <h6>{{ comment.idUser }}</h6>
                                                <p class="mb-0">{{ comment.content }}</p>
                                                <div class="d-flex flex-wrap align-items-center comment-activity">
                                                    {% set difference = date().diff(date(comment.commentDate)) %}
                                                    {% set leftDays = difference.days %}
                                                    {% if leftDays == 0 %}
                                                    <span> Today </span>
                                                    {% elseif leftDays == 1 %}
                                                    <span> Yesterday </span>
                                                    {% else %}
                                                        <span>{{ leftDays }}  Days Ago </span>
                                                    {% endif %}

                                                </div>
                                            </div>
                                        </div>
                                    </li>








                                    {% endfor %}
                                    {% endif %}
                                </ul>
                            <form id="CommentForm" class="comment-text d-flex align-items-center mt-3" method="post" action="{{ path('comment_event_new')}}">
                                <input name="comment" id="comment" type="text" class="form-control rounded" placeholder="Type here to comment...">
                                <div class="comment-attagement d-flex">
                                    <input  type="hidden" name="commentedEvent" id="commentedEvent" type="text" value={{ evenement.nomEvent}}>

                                </div>
                            </form>
                            </div>


                                

                                
                                






                            <a href="{{ path('evenement_index') }}">Back to UPCOMING EVENTS</a>
{% if CurrentUser.username == evenement.idOrg %}
                            <a style="position: absolute; top:15px; left: 480px;" href="{{ path('evenement_edit', {'id': evenement.id}) }}">Edit my Event</a>
                            {{ include('evenement/_delete_form.html.twig') }}

{% endif %}
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
    </div>



{% endblock %}
